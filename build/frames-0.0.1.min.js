(function($) {

!function(){var a={};!function(){function b(a,c,d){var e=function(){};e.prototype=a.prototype;var f=new e,g=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/;d=d||{};for(var h in d){var i=d[h],j=f[h];f[h]="function"==typeof j&&"function"==typeof i&&g.test(i)?function(a,b){return function(){var c=this.parent;this.parent=b;var d=a.apply(this,arguments);return this.parent=c,d}}(i,j):i}f.typename=c;var k=function(){f.init&&f.init.apply(this,arguments)};return k.prototype=f,k.prototype.constructor=k,k.extend=function(a,c){return"object"==typeof a&&(c=a,a="anonymous"),b(k,a,c)},k}a.object=b(Object,"Object",{})}(),function(){var b=Array.prototype,c=Object.prototype,d={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},e=/[&"'<>]/g,f=function(a){return d[a]},g=a.lib={};g.withPrettyErrors=function(a,b,c){try{return c()}catch(d){if(d.Update||(d=new g.TemplateError(d)),d.Update(a),!b){var e=d;d=new Error(e.message),d.name=e.name}throw d}},g.TemplateError=function(a,b,c){var d=this;return a instanceof Error?(d=a,a=a.name+": "+a.message):Error.captureStackTrace&&Error.captureStackTrace(d),d.name="Template render error",d.message=a,d.lineno=b,d.colno=c,d.firstUpdate=!0,d.Update=function(a){var b="("+(a||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?b+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(b+=" [Line "+this.lineno+"]")),b+="\n ",this.firstUpdate&&(b+=" "),this.message=b+(this.message||""),this.firstUpdate=!1,this},d},g.TemplateError.prototype=Error.prototype,g.escape=function(a){return a.replace(e,f)},g.isFunction=function(a){return"[object Function]"==c.toString.call(a)},g.isArray=Array.isArray||function(a){return"[object Array]"==c.toString.call(a)},g.isString=function(a){return"[object String]"==c.toString.call(a)},g.isObject=function(a){return"[object Object]"==c.toString.call(a)},g.groupBy=function(a,b){for(var c={},d=g.isFunction(b)?b:function(a){return a[b]},e=0;e<a.length;e++){var f=a[e],h=d(f,e);(c[h]||(c[h]=[])).push(f)}return c},g.toArray=function(a){return Array.prototype.slice.call(a)},g.without=function(a){var b=[];if(!a)return b;for(var c=-1,d=a.length,e=g.toArray(arguments).slice(1);++c<d;)-1===g.indexOf(e,a[c])&&b.push(a[c]);return b},g.extend=function(a,b){for(var c in b)a[c]=b[c];return a},g.repeat=function(a,b){for(var c="",d=0;b>d;d++)c+=a;return c},g.each=function(a,c,d){if(null!=a)if(b.each&&a.each==b.each)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;f>e;e++)c.call(d,a[e],e,a)},g.map=function(a,c){var d=[];if(null==a)return d;if(b.map&&a.map===b.map)return a.map(c);for(var e=0;e<a.length;e++)d[d.length]=c(a[e],e);return a.length===+a.length&&(d.length=a.length),d},g.asyncIter=function(a,b,c){function d(){e++,e<a.length?b(a[e],e,d,c):c()}var e=-1;d()},g.asyncFor=function(a,b,c){function d(){h++;var g=e[h];f>h?b(g,a[g],h,f,d):c()}var e=g.keys(a),f=e.length,h=-1;d()},g.indexOf=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){var d=this.length>>>0;for(c=+c||0,1/0===Math.abs(c)&&(c=0),0>c&&(c+=d,0>c&&(c=0));d>c;c++)if(a[c]===b)return c;return-1},Array.prototype.map||(Array.prototype.map=function(){throw new Error("map is unimplemented for this js engine")}),g.keys=function(a){if(Object.prototype.keys)return a.keys();var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}}(),function(){function b(a,b,c){a instanceof b&&c.push(a),a instanceof g&&a.findAll(b,c)}function c(a,b){function f(a,b,c){for(var e=a.split("\n"),f=0;f<e.length;f++){if(e[f]&&(c&&f>0||!c))for(var g=0;b>g;g++)d.print(" ");f===e.length-1?d.print(e[f]):d.puts(e[f])}}if(b=b||0,f(a.typename+": ",b),a instanceof i)f("\n"),e.each(a.children,function(a){c(a,b+2)});else if(a instanceof cb)f(a.extName+"."+a.prop),f("\n"),a.args&&c(a.args,b+2),a.contentArgs&&e.each(a.contentArgs,function(a){c(a,b+2)});else{var h=null,j=null;if(a.iterFields(function(a,b){a instanceof g?(h=h||{},h[b]=a):(j=j||{},j[b]=a)}),j?f(d.inspect(j,!0,null)+"\n",null,!0):f("\n"),h)for(var k in h)c(h[k],b+2)}}var d=a.util,e=a.lib,f=a.object,g=f.extend("Node",{init:function(a,b){this.lineno=a,this.colno=b;for(var c=this.fields,d=0,e=c.length;e>d;d++){var f=c[d],g=arguments[d+2];void 0===g&&(g=null),this[f]=g}},findAll:function(a,c){if(c=c||[],this instanceof i)for(var d=this.children,e=0,f=d.length;f>e;e++)b(d[e],a,c);else for(var g=this.fields,e=0,f=g.length;f>e;e++)b(this[g[e]],a,c);return c},iterFields:function(a){e.each(this.fields,function(b){a(this[b],b)},this)}}),h=g.extend("Value",{fields:["value"]}),i=g.extend("NodeList",{fields:["children"],init:function(a,b,c){this.parent(a,b,c||[])},addChild:function(a){this.children.push(a)}}),j=i.extend("Root"),k=h.extend("Literal"),l=h.extend("Symbol"),m=i.extend("Group"),n=i.extend("Array"),o=g.extend("Pair",{fields:["key","value"]}),p=i.extend("Dict"),q=g.extend("LookupVal",{fields:["target","val"]}),r=g.extend("If",{fields:["cond","body","else_"]}),s=r.extend("IfAsync"),t=g.extend("InlineIf",{fields:["cond","body","else_"]}),u=g.extend("For",{fields:["arr","name","body","else_"]}),v=u.extend("AsyncEach"),w=u.extend("AsyncAll"),x=g.extend("Macro",{fields:["name","args","body"]}),y=x.extend("Caller"),z=g.extend("Import",{fields:["template","target"]}),A=g.extend("FromImport",{fields:["template","names"],init:function(a,b,c,d){this.parent(a,b,c,d||new i)}}),B=g.extend("FunCall",{fields:["name","args"]}),C=B.extend("Filter"),D=C.extend("FilterAsync",{fields:["name","args","symbol"]}),E=p.extend("KeywordArgs"),F=g.extend("Block",{fields:["name","body"]}),G=g.extend("Super",{fields:["blockName","symbol"]}),H=g.extend("TemplateRef",{fields:["template"]}),I=H.extend("Extends"),J=H.extend("Include"),K=g.extend("Set",{fields:["targets","value"]}),L=i.extend("Output"),M=k.extend("TemplateData"),N=g.extend("UnaryOp",{fields:["target"]}),O=g.extend("BinOp",{fields:["left","right"]}),P=O.extend("In"),Q=O.extend("Or"),R=O.extend("And"),S=N.extend("Not"),T=O.extend("Add"),U=O.extend("Sub"),V=O.extend("Mul"),W=O.extend("Div"),X=O.extend("FloorDiv"),Y=O.extend("Mod"),Z=O.extend("Pow"),$=N.extend("Neg"),_=N.extend("Pos"),ab=g.extend("Compare",{fields:["expr","ops"]}),bb=g.extend("CompareOperand",{fields:["expr","type"]}),cb=(g.extend("CustomTag",{init:function(a,b,c){this.lineno=a,this.colno=b,this.name=c}}),g.extend("CallExtension",{fields:["extName","prop","args","contentArgs"],init:function(a,b,c,d){this.extName=a._name||a,this.prop=b,this.args=c||new i,this.contentArgs=d||[],this.autoescape=a.autoescape}})),db=cb.extend("CallExtensionAsync");a.nodes={Node:g,Root:j,NodeList:i,Value:h,Literal:k,Symbol:l,Group:m,Array:n,Pair:o,Dict:p,Output:L,TemplateData:M,If:r,IfAsync:s,InlineIf:t,For:u,AsyncEach:v,AsyncAll:w,Macro:x,Caller:y,Import:z,FromImport:A,FunCall:B,Filter:C,FilterAsync:D,KeywordArgs:E,Block:F,Super:G,Extends:I,Include:J,Set:K,LookupVal:q,BinOp:O,In:P,Or:Q,And:R,Not:S,Add:T,Sub:U,Mul:V,Div:W,FloorDiv:X,Mod:Y,Pow:Z,Neg:$,Pos:_,Compare:ab,CompareOperand:bb,CallExtension:cb,CallExtensionAsync:db,printNodes:c}}(),function(){function b(a,b,c){return function(){var f,g=e(arguments),h=d(arguments);if(g>a.length){f=Array.prototype.slice.call(arguments,0,a.length);for(var i=Array.prototype.slice.call(arguments,f.length,g),j=0;j<i.length;j++)j<b.length&&(h[b[j]]=i[j]);f.push(h)}else if(g<a.length){f=Array.prototype.slice.call(arguments,0,g);for(var j=g;j<a.length;j++){var k=a[j];f.push(h[k]),delete h[k]}f.push(h)}else f=arguments;return c.apply(this,f)}}function c(a){return a.__keywords=!0,a}function d(a){var b=a.length;if(b){var c=a[b-1];if(c&&c.hasOwnProperty("__keywords"))return c}return{}}function e(a){var b=a.length;if(0===b)return 0;var c=a[b-1];return c&&c.hasOwnProperty("__keywords")?b-1:b}function f(a){return"string"!=typeof a?a:void(this.val=a)}function g(a,b){return a instanceof f?new f(b):b.toString()}function h(a){var b=typeof a;return"string"===b?new f(a):"function"!==b?a:function(){var b=a.apply(this,arguments);return"string"==typeof b?new f(b):b}}function i(a,b){return a=void 0!==a&&null!==a?a:"",b&&"string"==typeof a&&(a=p.escape(a)),a}function j(a,b){return a=a||{},"function"==typeof a[b]?function(){return a[b].apply(a,arguments)}:a[b]}function k(a,b,c){if(!a)throw new Error("Unable to call `"+b+"`, which is undefined or falsey");if("function"!=typeof a)throw new Error("Unable to call `"+b+"`, which is not a function");return a.apply(this,c)}function l(a,b,c){var d=b.lookup(c);return void 0!==d&&null!==d?d:a.lookup(c)}function m(a,b,c){return a.lineno?a:new p.TemplateError(a,b,c)}function n(a,b,c,d){if(p.isArray(a)){var e=a.length;p.asyncIter(a,function(a,d,f){switch(b){case 1:c(a,d,e,f);break;case 2:c(a[0],a[1],d,e,f);break;case 3:c(a[0],a[1],a[2],d,e,f);break;default:a.push(d,f),c.apply(this,a)}},d)}else p.asyncFor(a,function(a,b,d,e,f){c(a,b,d,e,f)},d)}function o(a,b,c,d){function e(a,b){h++,g[a]=b,h==f&&d(null,g.join(""))}var f,g,h=0;if(p.isArray(a))if(f=a.length,g=new Array(f),0==f)d(null,"");else for(var i=0;i<a.length;i++){var j=a[i];switch(b){case 1:c(j,i,f,e);break;case 2:c(j[0],j[1],i,f,e);break;case 3:c(j[0],j[1],j[2],i,f,e);break;default:j.push(i,e),c.apply(this,j)}}else{var k=p.keys(a);if(f=k.length,g=new Array(f),0==f)d(null,"");else for(var i=0;i<k.length;i++){var l=k[i];c(l,a[l],i,f,e)}}}var p=a.lib,q=a.object,r=q.extend({init:function(a){this.variables={},this.parent=a},set:function(a,b,c){var d=a.split("."),e=this.variables,f=this;if(c){if(f=this.resolve(d[0]))return void f.set(a,b);f=this}for(var g=0;g<d.length-1;g++){var h=d[g];e[h]||(e[h]={}),e=e[h]}e[d[d.length-1]]=b},get:function(a){var b=this.variables[a];return void 0!==b&&null!==b?b:null},lookup:function(a){var b=this.parent,c=this.variables[a];return void 0!==c&&null!==c?c:b&&b.lookup(a)},resolve:function(a){var b=this.parent,c=this.variables[a];return null!=c?this:b&&b.resolve(a)},push:function(){return new r(this)},pop:function(){return this.parent}});f.prototype=Object.create(String.prototype),f.prototype.valueOf=function(){return this.val},f.prototype.toString=function(){return this.val},a.runtime={Frame:r,makeMacro:b,makeKeywordArgs:c,numArgs:e,suppressValue:i,memberLookup:j,contextOrFrameLookup:l,callWrap:k,handleError:m,isArray:p.isArray,keys:p.keys,SafeString:f,copySafeness:g,markSafe:h,asyncEach:n,asyncAll:o}}(),function(){function b(a,b,c,d){return{type:a,value:b,lineno:c,colno:d}}function c(a,b){this.str=a,this.index=0,this.len=a.length,this.lineno=0,this.colno=0,this.in_code=!1,b=b||{},this.tags={BLOCK_START:b.blockStart||h,BLOCK_END:b.blockEnd||i,VARIABLE_START:b.variableStart||j,VARIABLE_END:b.variableEnd||k,COMMENT_START:b.commentStart||l,COMMENT_END:b.commentEnd||m}}var d=a.lib,e=" \n	\r",f="()[]{}%*-+/#,:|.<>=!",g="0123456789",h="{%",i="%}",j="{{",k="}}",l="{#",m="#}",n="string",o="whitespace",p="data",q="block-start",r="block-end",s="variable-start",t="variable-end",u="comment",v="left-paren",w="right-paren",x="left-bracket",y="right-bracket",z="left-curly",A="right-curly",B="operator",C="comma",D="colon",E="pipe",F="int",G="float",H="boolean",I="symbol",J="special",K="regex";c.prototype.nextToken=function(){var a=this.lineno,c=this.colno;if(this.in_code){var h,i=this.current();if(this.is_finished())return null;if('"'==i||"'"==i)return b(n,this.parseString(i),a,c);if(h=this._extract(e))return b(o,h,a,c);if((h=this._extractString(this.tags.BLOCK_END))||(h=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,b(r,h,a,c);if(h=this._extractString(this.tags.VARIABLE_END))return this.in_code=!1,b(t,h,a,c);if("r"===i&&"/"===this.str.charAt(this.index+1)){this.forwardN(2);for(var j="";!this.is_finished();){if("/"===this.current()&&"\\"!==this.previous()){this.forward();break}j+=this.current(),this.forward()}for(var k=["g","i","m","y"],l="";!this.is_finished();){var m=-1!==k.indexOf(this.current());if(!m)break;l+=this.current(),this.forward()}return b(K,{body:j,flags:l},a,c)}if(-1!=f.indexOf(i)){this.forward();var J,L=["==","!=","<=",">=","//","**"],M=i+this.current();switch(-1!==d.indexOf(L,M)&&(this.forward(),i=M),i){case"(":J=v;break;case")":J=w;break;case"[":J=x;break;case"]":J=y;break;case"{":J=z;break;case"}":J=A;break;case",":J=C;break;case":":J=D;break;case"|":J=E;break;default:J=B}return b(J,i,a,c)}if(h=this._extractUntil(e+f),h.match(/^[-+]?[0-9]+$/)){if("."==this.current()){this.forward();var N=this._extract(g);return b(G,h+"."+N,a,c)}return b(F,h,a,c)}if(h.match(/^(true|false)$/))return b(H,h,a,c);if(h)return b(I,h,a,c);throw new Error("Unexpected value while parsing: "+h)}var h,O=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.is_finished())return null;if((h=this._extractString(this.tags.BLOCK_START+"-"))||(h=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,b(q,h,a,c);if(h=this._extractString(this.tags.VARIABLE_START))return this.in_code=!0,b(s,h,a,c);h="";var P,Q=!1;for(this._matches(this.tags.COMMENT_START)&&(Q=!0,h=this._extractString(this.tags.COMMENT_START));null!==(P=this._extractUntil(O))&&(h+=P,!(this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))||Q);){if(this._matches(this.tags.COMMENT_END)){if(!Q)throw new Error("unexpected end of comment");h+=this._extractString(this.tags.COMMENT_END);break}h+=this.current(),this.forward()}if(null===P&&Q)throw new Error("expected end of comment, got end of file");return b(Q?u:p,h,a,c)},c.prototype.parseString=function(a){this.forward();for(var b=(this.lineno,this.colno,"");!this.is_finished()&&this.current()!=a;){var c=this.current();if("\\"==c){switch(this.forward(),this.current()){case"n":b+="\n";break;case"t":b+="	";break;case"r":b+="\r";break;default:b+=this.current()}this.forward()}else b+=c,this.forward()}return this.forward(),b},c.prototype._matches=function(a){if(this.index+a.length>this.length)return null;var b=this.str.slice(this.index,this.index+a.length);return b==a},c.prototype._extractString=function(a){return this._matches(a)?(this.index+=a.length,a):null},c.prototype._extractUntil=function(a){return this._extractMatching(!0,a||"")},c.prototype._extract=function(a){return this._extractMatching(!1,a)},c.prototype._extractMatching=function(a,b){if(this.is_finished())return null;var c=b.indexOf(this.current());if(a&&-1==c||!a&&-1!=c){var d=this.current();this.forward();for(var e=b.indexOf(this.current());(a&&-1==e||!a&&-1!=e)&&!this.is_finished();)d+=this.current(),this.forward(),e=b.indexOf(this.current());return d}return""},c.prototype.is_finished=function(){return this.index>=this.len},c.prototype.forwardN=function(a){for(var b=0;a>b;b++)this.forward()},c.prototype.forward=function(){this.index++,"\n"==this.previous()?(this.lineno++,this.colno=0):this.colno++},c.prototype.back=function(){if(this.index--,"\n"==this.current()){this.lineno--;var a=this.src.lastIndexOf("\n",this.index-1);this.colno=-1==a?this.index:this.index-a}else this.colno--},c.prototype.current=function(){return this.is_finished()?"":this.str.charAt(this.index)},c.prototype.previous=function(){return this.str.charAt(this.index-1)},a.lexer={lex:function(a,b){return new c(a,b)},TOKEN_STRING:n,TOKEN_WHITESPACE:o,TOKEN_DATA:p,TOKEN_BLOCK_START:q,TOKEN_BLOCK_END:r,TOKEN_VARIABLE_START:s,TOKEN_VARIABLE_END:t,TOKEN_COMMENT:u,TOKEN_LEFT_PAREN:v,TOKEN_RIGHT_PAREN:w,TOKEN_LEFT_BRACKET:x,TOKEN_RIGHT_BRACKET:y,TOKEN_LEFT_CURLY:z,TOKEN_RIGHT_CURLY:A,TOKEN_OPERATOR:B,TOKEN_COMMA:C,TOKEN_COLON:D,TOKEN_PIPE:E,TOKEN_INT:F,TOKEN_FLOAT:G,TOKEN_BOOLEAN:H,TOKEN_SYMBOL:I,TOKEN_SPECIAL:J,TOKEN_REGEX:K}}(),function(){var b=a.lexer,c=a.nodes,d=a.object,e=a.lib,f=d.extend({init:function(a){this.tokens=a,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},nextToken:function(a){var c;if(this.peeked){if(a||this.peeked.type!=b.TOKEN_WHITESPACE)return c=this.peeked,this.peeked=null,c;this.peeked=null}if(c=this.tokens.nextToken(),!a)for(;c&&c.type==b.TOKEN_WHITESPACE;)c=this.tokens.nextToken();return c},peekToken:function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},pushToken:function(a){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=a},fail:function(a,b,c){if((void 0===b||void 0===c)&&this.peekToken()){var d=this.peekToken();b=d.lineno,c=d.colno}throw void 0!==b&&(b+=1),void 0!==c&&(c+=1),new e.TemplateError(a,b,c)},skip:function(a){var b=this.nextToken();return b&&b.type==a?!0:(this.pushToken(b),!1)},expect:function(a){var b=this.nextToken();return b.type!==a&&this.fail("expected "+a+", got "+b.type,b.lineno,b.colno),b},skipValue:function(a,b){var c=this.nextToken();return c&&c.type==a&&c.value==b?!0:(this.pushToken(c),!1)},skipWhitespace:function(){return this.skip(b.TOKEN_WHITESPACE)},skipSymbol:function(a){return this.skipValue(b.TOKEN_SYMBOL,a)},advanceAfterBlockEnd:function(a){if(!a){var c=this.peekToken();c||this.fail("unexpected end of file"),c.type!=b.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),a=this.nextToken().value}var c=this.nextToken();c&&c.type==b.TOKEN_BLOCK_END?"-"===c.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+a+" statement")},advanceAfterVariableEnd:function(){this.skip(b.TOKEN_VARIABLE_END)||this.fail("expected variable end")},parseFor:function(){var a,d,e=this.peekToken();this.skipSymbol("for")?(a=new c.For(e.lineno,e.colno),d="endfor"):this.skipSymbol("asyncEach")?(a=new c.AsyncEach(e.lineno,e.colno),d="endeach"):this.skipSymbol("asyncAll")?(a=new c.AsyncAll(e.lineno,e.colno),d="endall"):this.fail("parseFor: expected for{Async}",e.lineno,e.colno),a.name=this.parsePrimary(),a.name instanceof c.Symbol||this.fail("parseFor: variable name expected for loop");var f=this.peekToken().type;if(f==b.TOKEN_COMMA){var g=a.name;for(a.name=new c.Array(g.lineno,g.colno),a.name.addChild(g);this.skip(b.TOKEN_COMMA);){var h=this.parsePrimary();a.name.addChild(h)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',e.lineno,e.colno),a.arr=this.parseExpression(),this.advanceAfterBlockEnd(e.value),a.body=this.parseUntilBlocks(d,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),a.else_=this.parseUntilBlocks(d)),this.advanceAfterBlockEnd(),a},parseMacro:function(){var a=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var b=this.parsePrimary(!0),d=this.parseSignature(),e=new c.Macro(a.lineno,a.colno,b,d);return this.advanceAfterBlockEnd(a.value),e.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),e},parseCall:function(){var a=this.peekToken();this.skipSymbol("call")||this.fail("expected call");var b=this.parseSignature(!0)||new c.NodeList,d=this.parsePrimary();this.advanceAfterBlockEnd(a.value);var e=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();var f=new c.Symbol(a.lineno,a.colno,"caller"),g=new c.Caller(a.lineno,a.colno,f,b,e),h=d.args.children;h[h.length-1]instanceof c.KeywordArgs||h.push(new c.KeywordArgs);var i=h[h.length-1];return i.addChild(new c.Pair(a.lineno,a.colno,f,g)),new c.Output(a.lineno,a.colno,[d])},parseImport:function(){var a=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",a.lineno,a.colno);var b=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',a.lineno,a.colno);var d=this.parsePrimary(),e=new c.Import(a.lineno,a.colno,b,d);return this.advanceAfterBlockEnd(a.value),e},parseFrom:function(){var a=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var d=this.parsePrimary(),e=new c.FromImport(a.lineno,a.colno,d,new c.NodeList);this.skipSymbol("import")||this.fail("parseFrom: expected import",a.lineno,a.colno);for(var f=e.names;;){var g=this.peekToken();if(g.type==b.TOKEN_BLOCK_END){f.children.length||this.fail("parseFrom: Expected at least one import name",a.lineno,a.colno),"-"==g.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}f.children.length>0&&!this.skip(b.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",a.lineno,a.colno);var h=this.parsePrimary();if("_"==h.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",h.lineno,h.colno),this.skipSymbol("as")){var i=this.parsePrimary();f.addChild(new c.Pair(h.lineno,h.colno,h,i))}else f.addChild(h)}return e},parseBlock:function(){var a=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",a.lineno,a.colno);var b=new c.Block(a.lineno,a.colno);return b.name=this.parsePrimary(),b.name instanceof c.Symbol||this.fail("parseBlock: variable name expected",a.lineno,a.colno),this.advanceAfterBlockEnd(a.value),b.body=this.parseUntilBlocks("endblock"),this.peekToken()||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(),b},parseTemplateRef:function(a,b){var c=this.peekToken();this.skipSymbol(a)||this.fail("parseTemplateRef: expected "+a);var d=new b(c.lineno,c.colno);return d.template=this.parseExpression(),this.advanceAfterBlockEnd(c.value),d},parseExtends:function(){return this.parseTemplateRef("extends",c.Extends)},parseInclude:function(){return this.parseTemplateRef("include",c.Include)},parseIf:function(){var a,b=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")?a=new c.If(b.lineno,b.colno):this.skipSymbol("ifAsync")?a=new c.IfAsync(b.lineno,b.colno):this.fail("parseIf: expected if or elif",b.lineno,b.colno),a.cond=this.parseExpression(),this.advanceAfterBlockEnd(b.value),a.body=this.parseUntilBlocks("elif","else","endif");var d=this.peekToken();switch(d&&d.value){case"elif":a.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),a.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":a.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected endif, else, or endif, got end of file")}return a},parseSet:function(){var a=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",a.lineno,a.colno);for(var d,e=new c.Set(a.lineno,a.colno,[]);(d=this.parsePrimary())&&(e.targets.push(d),this.skip(b.TOKEN_COMMA)););return this.skipValue(b.TOKEN_OPERATOR,"=")||this.fail("parseSet: expected = in set tag",a.lineno,a.colno),e.value=this.parseExpression(),this.advanceAfterBlockEnd(a.value),e},parseStatement:function(){var a,d=this.peekToken();if(d.type!=b.TOKEN_SYMBOL&&this.fail("tag name expected",d.lineno,d.colno),this.breakOnBlocks&&-1!==e.indexOf(this.breakOnBlocks,d.value))return null;switch(d.value){case"raw":return this.parseRaw();case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();default:if(this.extensions.length)for(var f=0;f<this.extensions.length;f++){var g=this.extensions[f];if(-1!==e.indexOf(g.tags||[],d.value))return g.parse(this,c,b)}this.fail("unknown block tag: "+d.value,d.lineno,d.colno)}return a},parseRaw:function(){this.advanceAfterBlockEnd();for(var a="",d=this.peekToken();;){var e=this.nextToken(!0);if(e||this.fail("expected endraw, got end of file"),e.type==b.TOKEN_BLOCK_START){var f=null,g=this.nextToken(!0);if(g.type==b.TOKEN_WHITESPACE&&(f=g,g=this.nextToken()),g.type==b.TOKEN_SYMBOL&&"endraw"==g.value){this.advanceAfterBlockEnd(g.value);break}a+=e.value,f&&(a+=f.value),a+=g.value}else a+=e.type===b.TOKEN_STRING?'"'+e.value+'"':e.value}var h=new c.Output(d.lineno,d.colno,[new c.TemplateData(d.lineno,d.colno,a)]);return h},parsePostfix:function(a){for(var d=this.peekToken();d;){if(d.type==b.TOKEN_LEFT_PAREN)a=new c.FunCall(d.lineno,d.colno,a,this.parseSignature());else if(d.type==b.TOKEN_LEFT_BRACKET){var e=this.parseAggregate();e.children.length>1&&this.fail("invalid index"),a=new c.LookupVal(d.lineno,d.colno,a,e.children[0])}else{if(d.type!=b.TOKEN_OPERATOR||"."!=d.value)break;this.nextToken();var f=this.nextToken();f.type!=b.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+f.value,f.lineno,f.colno);var e=new c.Literal(f.lineno,f.colno,f.value);a=new c.LookupVal(d.lineno,d.colno,a,e)}d=this.peekToken()}return a},parseExpression:function(){var a=this.parseInlineIf();return a},parseInlineIf:function(){var a=this.parseIn();if(this.skipSymbol("if")){var b=this.parseIn(),d=a;a=new c.InlineIf(a.lineno,a.colno),a.body=d,a.cond=b,a.else_=this.skipSymbol("else")?this.parseIn():null}return a},parseIn:function(){for(var a=this.parseOr();;){var d=this.nextToken();if(!d)break;var e=d.type==b.TOKEN_SYMBOL&&"not"==d.value;if(e||this.pushToken(d),!this.skipSymbol("in")){e&&this.pushToken(d);break}var f=this.parseOr();a=new c.In(a.lineno,a.colno,a,f),e&&(a=new c.Not(a.lineno,a.colno,a))}return a},parseOr:function(){for(var a=this.parseAnd();this.skipSymbol("or");){var b=this.parseAnd();a=new c.Or(a.lineno,a.colno,a,b)}return a},parseAnd:function(){for(var a=this.parseNot();this.skipSymbol("and");){var b=this.parseNot();a=new c.And(a.lineno,a.colno,a,b)}return a},parseNot:function(){var a=this.peekToken();return this.skipSymbol("not")?new c.Not(a.lineno,a.colno,this.parseNot()):this.parseCompare()},parseCompare:function(){for(var a=["==","!=","<",">","<=",">="],b=this.parseAdd(),d=[];;){var f=this.nextToken();if(!f)break;if(-1===e.indexOf(a,f.value)){this.pushToken(f);break}d.push(new c.CompareOperand(f.lineno,f.colno,this.parseAdd(),f.value))}return d.length?new c.Compare(d[0].lineno,d[0].colno,b,d):b},parseAdd:function(){for(var a=this.parseSub();this.skipValue(b.TOKEN_OPERATOR,"+");){var d=this.parseSub();a=new c.Add(a.lineno,a.colno,a,d)}return a},parseSub:function(){for(var a=this.parseMul();this.skipValue(b.TOKEN_OPERATOR,"-");){var d=this.parseMul();a=new c.Sub(a.lineno,a.colno,a,d)}return a},parseMul:function(){for(var a=this.parseDiv();this.skipValue(b.TOKEN_OPERATOR,"*");){var d=this.parseDiv();a=new c.Mul(a.lineno,a.colno,a,d)}return a},parseDiv:function(){for(var a=this.parseFloorDiv();this.skipValue(b.TOKEN_OPERATOR,"/");){var d=this.parseFloorDiv();a=new c.Div(a.lineno,a.colno,a,d)}return a},parseFloorDiv:function(){for(var a=this.parseMod();this.skipValue(b.TOKEN_OPERATOR,"//");){var d=this.parseMod();a=new c.FloorDiv(a.lineno,a.colno,a,d)}return a},parseMod:function(){for(var a=this.parsePow();this.skipValue(b.TOKEN_OPERATOR,"%");){var d=this.parsePow();a=new c.Mod(a.lineno,a.colno,a,d)}return a},parsePow:function(){for(var a=this.parseUnary();this.skipValue(b.TOKEN_OPERATOR,"**");){var d=this.parseUnary();a=new c.Pow(a.lineno,a.colno,a,d)}return a},parseUnary:function(a){var d,e=this.peekToken();return d=this.skipValue(b.TOKEN_OPERATOR,"-")?new c.Neg(e.lineno,e.colno,this.parseUnary(!0)):this.skipValue(b.TOKEN_OPERATOR,"+")?new c.Pos(e.lineno,e.colno,this.parseUnary(!0)):this.parsePrimary(),a||(d=this.parseFilter(d)),d},parsePrimary:function(a){var d=this.nextToken(),e=null,f=null;return d?d.type==b.TOKEN_STRING?e=d.value:d.type==b.TOKEN_INT?e=parseInt(d.value,10):d.type==b.TOKEN_FLOAT?e=parseFloat(d.value):d.type==b.TOKEN_BOOLEAN?"true"==d.value?e=!0:"false"==d.value?e=!1:this.fail("invalid boolean: "+d.val,d.lineno,d.colno):d.type==b.TOKEN_REGEX&&(e=new RegExp(d.value.body,d.value.flags)):this.fail("expected expression, got end of file"),null!==e?f=new c.Literal(d.lineno,d.colno,e):d.type==b.TOKEN_SYMBOL?(f=new c.Symbol(d.lineno,d.colno,d.value),a||(f=this.parsePostfix(f))):(this.pushToken(d),f=this.parseAggregate()),f?f:void this.fail("unexpected token: "+d.value,d.lineno,d.colno)},parseFilter:function(a){for(;this.skip(b.TOKEN_PIPE);){for(var d=this.expect(b.TOKEN_SYMBOL),e=d.value;this.skipValue(b.TOKEN_OPERATOR,".");)e+="."+this.expect(b.TOKEN_SYMBOL).value;if(a=new c.Filter(d.lineno,d.colno,new c.Symbol(d.lineno,d.colno,e),new c.NodeList(d.lineno,d.colno,[a])),this.peekToken().type==b.TOKEN_LEFT_PAREN){var f=this.parsePostfix(a);a.args.children=a.args.children.concat(f.args.children)}}return a},parseAggregate:function(){var a,d=this.nextToken();switch(d.type){case b.TOKEN_LEFT_PAREN:a=new c.Group(d.lineno,d.colno);break;case b.TOKEN_LEFT_BRACKET:a=new c.Array(d.lineno,d.colno);break;case b.TOKEN_LEFT_CURLY:a=new c.Dict(d.lineno,d.colno);break;default:return null}for(;;){var e=this.peekToken().type;if(e==b.TOKEN_RIGHT_PAREN||e==b.TOKEN_RIGHT_BRACKET||e==b.TOKEN_RIGHT_CURLY){this.nextToken();break}if(a.children.length>0&&(this.skip(b.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",d.lineno,d.colno)),a instanceof c.Dict){var f=this.parsePrimary();this.skip(b.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",d.lineno,d.colno);var g=this.parseExpression();a.addChild(new c.Pair(f.lineno,f.colno,f,g))}else{var h=this.parseExpression();a.addChild(h)}}return a},parseSignature:function(a,d){var e=this.peekToken();if(!d&&e.type!=b.TOKEN_LEFT_PAREN){if(a)return null;this.fail("expected arguments",e.lineno,e.colno)}e.type==b.TOKEN_LEFT_PAREN&&(e=this.nextToken());for(var f=new c.NodeList(e.lineno,e.colno),g=new c.KeywordArgs(e.lineno,e.colno),h=!1;;){if(e=this.peekToken(),!d&&e.type==b.TOKEN_RIGHT_PAREN){this.nextToken();break}if(d&&e.type==b.TOKEN_BLOCK_END)break;if(h&&!this.skip(b.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",e.lineno,e.colno);else{var i=this.parseExpression();this.skipValue(b.TOKEN_OPERATOR,"=")?g.addChild(new c.Pair(i.lineno,i.colno,i,this.parseExpression())):f.addChild(i)}h=!0}return g.children.length&&f.addChild(g),f},parseUntilBlocks:function(){var a=this.breakOnBlocks;this.breakOnBlocks=e.toArray(arguments);var b=this.parse();return this.breakOnBlocks=a,b},parseNodes:function(){for(var a,d=[];a=this.nextToken();)if(a.type==b.TOKEN_DATA){var e=a.value,f=this.peekToken(),g=f&&f.value;this.dropLeadingWhitespace&&(e=e.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),f&&f.type==b.TOKEN_BLOCK_START&&"-"==g.charAt(g.length-1)&&(e=e.replace(/\s*$/,"")),d.push(new c.Output(a.lineno,a.colno,[new c.TemplateData(a.lineno,a.colno,e)]))}else if(a.type==b.TOKEN_BLOCK_START){var h=this.parseStatement();if(!h)break;d.push(h)}else if(a.type==b.TOKEN_VARIABLE_START){var i=this.parseExpression();this.advanceAfterVariableEnd(),d.push(new c.Output(a.lineno,a.colno,[i]))}else a.type!=b.TOKEN_COMMENT&&this.fail("Unexpected token at top-level: "+a.type,a.lineno,a.colno);return d},parse:function(){return new c.NodeList(0,0,this.parseNodes())},parseAsRoot:function(){return new c.Root(0,0,this.parseNodes())}});a.parser={parse:function(a,c,d){var e=new f(b.lex(a,d));return void 0!==c&&(e.extensions=c),e.parseAsRoot()}}}(),function(){function b(){return"hole_"+n++}function c(a,b){for(var c=null,d=0;d<a.length;d++){var e=b(a[d]);e!==a[d]&&(c||(c=a.slice()),c[d]=e)}return c||a}function d(a,b,e){if(!(a instanceof l.Node))return a;if(!e){var f=b(a);if(f&&f!==a)return f}if(a instanceof l.NodeList){var g=c(a.children,function(a){return d(a,b,e)});g!==a.children&&(a=new l[a.typename](a.lineno,a.colno,g))}else if(a instanceof l.CallExtension){var h=d(a.args,b,e),i=c(a.contentArgs,function(a){return d(a,b,e)});(h!==a.args||i!==a.contentArgs)&&(a=new l[a.typename](a.extName,a.prop,h,i))}else{var j=a.fields.map(function(b){return a[b]}),k=c(j,function(a){return d(a,b,e)});k!==j&&(a=new l[a.typename](a.lineno,a.colno),k.forEach(function(b,c){a[a.fields[c]]=b}))}return e?b(a)||a:a}function e(a,b){return d(a,b,!0)}function f(a,c,d){var f=[],g=e(d?a[d]:a,function(a){if(a instanceof l.Block)return a;if(a instanceof l.Filter&&-1!==m.indexOf(c,a.name.value)||a instanceof l.CallExtensionAsync){var d=new l.Symbol(a.lineno,a.colno,b());return f.push(new l.FilterAsync(a.lineno,a.colno,a.name,a.args,d)),d}});return d?a[d]=g:a=g,f.length?(f.push(a),new l.NodeList(a.lineno,a.colno,f)):a
}function g(a,b){return e(a,function(a){return a instanceof l.Output?f(a,b):a instanceof l.For?f(a,b,"arr"):a instanceof l.If?f(a,b,"cond"):a instanceof l.CallExtension?f(a,b,"args"):void 0})}function h(a){return d(a,function(a){if(a instanceof l.Block){var c=!1,e=b();a.body=d(a.body,function(a){return a instanceof l.FunCall&&"super"==a.name.value?(c=!0,new l.Symbol(a.lineno,a.colno,e)):void 0}),c&&a.body.children.unshift(new l.Super(0,0,a.name,new l.Symbol(0,0,e)))}})}function i(a){return e(a,function(a){if(a instanceof l.If||a instanceof l.For){var b=!1;if(d(a,function(a){return a instanceof l.FilterAsync||a instanceof l.IfAsync||a instanceof l.AsyncEach||a instanceof l.AsyncAll||a instanceof l.CallExtensionAsync?(b=!0,a):void 0}),b){if(a instanceof l.If)return new l.IfAsync(a.lineno,a.colno,a.cond,a.body,a.else_);if(a instanceof l.For)return new l.AsyncEach(a.lineno,a.colno,a.arr,a.name,a.body,a.else_)}}})}function j(a,b){return i(h(g(a,b)))}function k(a,b){return j(a,b||[])}var l=a.nodes,m=a.lib,n=0;a.transformer={transform:k}}(),function(){function b(a){return function(b,c){this.compile(b.left,c),this.emit(a),this.compile(b.right,c)}}var c=a.lib,d=a.parser,e=a.transformer,f=a.nodes,g=a.object,h=a.runtime.Frame,i={"==":"==","!=":"!=","<":"<",">":">","<=":"<=",">=":">="},j=g.extend({init:function(){this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this.isChild=!1,this.scopeClosers=""},fail:function(a,b,d){throw void 0!==b&&(b+=1),void 0!==d&&(d+=1),new c.TemplateError(a,b,d)},pushBufferId:function(a){this.bufferStack.push(this.buffer),this.buffer=a,this.emit("var "+this.buffer+' = "";')},popBufferId:function(){this.buffer=this.bufferStack.pop()},emit:function(a){this.codebuf.push(a)},emitLine:function(a){this.emit(a+"\n")},emitLines:function(){c.each(c.toArray(arguments),function(a){this.emitLine(a)},this)},emitFuncBegin:function(a){this.buffer="output",this.scopeClosers="",this.emitLine("function "+a+"(env, context, frame, runtime, cb) {"),this.emitLine("var lineno = null;"),this.emitLine("var colno = null;"),this.emitLine("var "+this.buffer+' = "";'),this.emitLine("try {")},emitFuncEnd:function(a){a||this.emitLine("cb(null, "+this.buffer+");"),this.closeScopeLevels(),this.emitLine("} catch (e) {"),this.emitLine("  cb(runtime.handleError(e, lineno, colno));"),this.emitLine("}"),this.emitLine("}"),this.buffer=null},addScopeLevel:function(){this.scopeClosers+="})"},closeScopeLevels:function(){this.emitLine(this.scopeClosers+";"),this.scopeClosers=""},withScopedSyntax:function(a){var b=this.scopeClosers;this.scopeClosers="",a.call(this),this.closeScopeLevels(),this.scopeClosers=b},makeCallback:function(a){var b=this.tmpid();return"function("+b+(a?","+a:"")+") {\nif("+b+") { cb("+b+"); return; }"},tmpid:function(){return this.lastId++,"t_"+this.lastId},_bufferAppend:function(a){this.emit(this.buffer+" += runtime.suppressValue("),a.call(this),this.emit(", env.autoesc);\n")},_compileChildren:function(a,b){for(var c=a.children,d=0,e=c.length;e>d;d++)this.compile(c[d],b)},_compileAggregate:function(a,b,c,d){c&&this.emit(c);for(var e=0;e<a.children.length;e++)e>0&&this.emit(","),this.compile(a.children[e],b);d&&this.emit(d)},_compileExpression:function(a,b){this.assertType(a,f.Literal,f.Symbol,f.Group,f.Array,f.Dict,f.FunCall,f.Caller,f.Filter,f.LookupVal,f.Compare,f.InlineIf,f.In,f.And,f.Or,f.Not,f.Add,f.Sub,f.Mul,f.Div,f.FloorDiv,f.Mod,f.Pow,f.Neg,f.Pos,f.Compare,f.NodeList),this.compile(a,b)},assertType:function(a){for(var b=c.toArray(arguments).slice(1),d=!1,e=0;e<b.length;e++)a instanceof b[e]&&(d=!0);d||this.fail("assertType: invalid type: "+a.typename,a.lineno,a.colno)},compileCallExtension:function(a,b,d){var e=(a.extName,a.args),g=a.contentArgs,h="boolean"==typeof a.autoescape?a.autoescape:!0;if(d||this.emit(this.buffer+" += runtime.suppressValue("),this.emit('env.getExtension("'+a.extName+'")["'+a.prop+'"]('),this.emit("context"),(e||g)&&this.emit(","),e&&(e instanceof f.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),c.each(e.children,function(a,c){this._compileExpression(a,b),(c!=e.children.length-1||g.length)&&this.emit(",")},this)),g.length&&c.each(g,function(a,c){if(c>0&&this.emit(","),a){var d=this.tmpid();this.emitLine("function(cb) {"),this.emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}"),this.pushBufferId(d),this.withScopedSyntax(function(){this.compile(a,b),this.emitLine("cb(null, "+d+");")}),this.popBufferId(),this.emitLine("return "+d+";"),this.emitLine("}")}else this.emit("null")},this),d){var i=this.tmpid();this.emitLine(", "+this.makeCallback(i)),this.emitLine(this.buffer+" += runtime.suppressValue("+i+", "+h+" && env.autoesc);"),this.addScopeLevel()}else this.emit(")"),this.emit(", "+h+" && env.autoesc);\n")},compileCallExtensionAsync:function(a,b){this.compileCallExtension(a,b,!0)},compileNodeList:function(a,b){this._compileChildren(a,b)},compileLiteral:function(a){if("string"==typeof a.value){var b=a.value.replace(/\\/g,"\\\\");b=b.replace(/"/g,'\\"'),b=b.replace(/\n/g,"\\n"),b=b.replace(/\r/g,"\\r"),b=b.replace(/\t/g,"\\t"),this.emit('"'+b+'"')}else this.emit(a.value.toString())},compileSymbol:function(a,b){var c,d=a.value;this.emit((c=b.lookup(d))?c:'runtime.contextOrFrameLookup(context, frame, "'+d+'")')},compileGroup:function(a,b){this._compileAggregate(a,b,"(",")")},compileArray:function(a,b){this._compileAggregate(a,b,"[","]")},compileDict:function(a,b){this._compileAggregate(a,b,"{","}")},compilePair:function(a,b){var c=a.key,d=a.value;c instanceof f.Symbol?c=new f.Literal(c.lineno,c.colno,c.value):c instanceof f.Literal&&"string"==typeof c.value||this.fail("compilePair: Dict keys must be strings or names",c.lineno,c.colno),this.compile(c,b),this.emit(": "),this._compileExpression(d,b)},compileInlineIf:function(a,b){this.emit("("),this.compile(a.cond,b),this.emit("?"),this.compile(a.body,b),this.emit(":"),null!==a.else_?this.compile(a.else_,b):this.emit('""'),this.emit(")")},compileIn:function(a,b){this.emit("("),this.compile(a.right,b),this.emit(".indexOf("),this.compile(a.left,b),this.emit(") !== -1)")},compileOr:b(" || "),compileAnd:b(" && "),compileAdd:b(" + "),compileSub:b(" - "),compileMul:b(" * "),compileDiv:b(" / "),compileMod:b(" % "),compileNot:function(a,b){this.emit("!"),this.compile(a.target,b)},compileFloorDiv:function(a,b){this.emit("Math.floor("),this.compile(a.left,b),this.emit(" / "),this.compile(a.right,b),this.emit(")")},compilePow:function(a,b){this.emit("Math.pow("),this.compile(a.left,b),this.emit(", "),this.compile(a.right,b),this.emit(")")},compileNeg:function(a,b){this.emit("-"),this.compile(a.target,b)},compilePos:function(a,b){this.emit("+"),this.compile(a.target,b)},compileCompare:function(a,b){this.compile(a.expr,b);for(var c=0;c<a.ops.length;c++){var d=a.ops[c];this.emit(" "+i[d.type]+" "),this.compile(d.expr,b)}},compileLookupVal:function(a,b){this.emit("runtime.memberLookup(("),this._compileExpression(a.target,b),this.emit("),"),this._compileExpression(a.val,b),this.emit(", env.autoesc)")},_getNodeName:function(a){switch(a.typename){case"Symbol":return a.value;case"FunCall":return"the return value of ("+this._getNodeName(a.name)+")";case"LookupVal":return this._getNodeName(a.target)+'["'+this._getNodeName(a.val)+'"]';case"Literal":return a.value.toString().substr(0,10);default:return"--expression--"}},compileFunCall:function(a,b){this.emit("(lineno = "+a.lineno+", colno = "+a.colno+", "),this.emit("runtime.callWrap("),this._compileExpression(a.name,b),this.emit(', "'+this._getNodeName(a.name).replace(/"/g,'\\"')+'", '),this._compileAggregate(a.args,b,"[","])"),this.emit(")")},compileFilter:function(a,b){var c=a.name;this.assertType(c,f.Symbol),this.emit('env.getFilter("'+c.value+'").call(context, '),this._compileAggregate(a.args,b),this.emit(")")},compileFilterAsync:function(a,b){var c=a.name;this.assertType(c,f.Symbol);var d=a.symbol.value;b.set(d,d),this.emit('env.getFilter("'+c.value+'").call(context, '),this._compileAggregate(a.args,b),this.emitLine(", "+this.makeCallback(d)),this.addScopeLevel()},compileKeywordArgs:function(a,b){var d=[];c.each(a.children,function(a){d.push(a.key.value)}),this.emit("runtime.makeKeywordArgs("),this.compileDict(a,b),this.emit(")")},compileSet:function(a,b){var d=[];c.each(a.targets,function(a){var c=a.value,e=b.lookup(c);null==e&&(e=this.tmpid(),this.emitLine("var "+e+";")),d.push(e)},this),this.emit(d.join(" = ")+" = "),this._compileExpression(a.value,b),this.emitLine(";"),c.each(a.targets,function(a,b){var c=d[b],e=a.value;this.emitLine('frame.set("'+e+'", '+c+", true);"),this.emitLine("if(!frame.parent) {"),this.emitLine('context.setVariable("'+e+'", '+c+");"),"_"!=e.charAt(0)&&this.emitLine('context.addExport("'+e+'");'),this.emitLine("}")},this)},compileIf:function(a,b,c){this.emit("if("),this._compileExpression(a.cond,b),this.emitLine(") {"),this.withScopedSyntax(function(){this.compile(a.body,b),c&&this.emit("cb()")}),a.else_?(this.emitLine("}\nelse {"),this.withScopedSyntax(function(){this.compile(a.else_,b),c&&this.emit("cb()")})):c&&(this.emitLine("}\nelse {"),this.emit("cb()")),this.emitLine("}")},compileIfAsync:function(a,b){this.emit("(function(cb) {"),this.compileIf(a,b,!0),this.emit("})(function() {"),this.addScopeLevel()},emitLoopBindings:function(a,b,c,d){var e={index:c+" + 1",index0:c,revindex:d+" - "+c,revindex0:d+" - "+c+" - 1",first:c+" === 0",last:c+" === "+d+" - 1",length:d};for(var f in e)this.emitLine('frame.set("loop.'+f+'", '+e[f]+");")},compileFor:function(a,b){var c=this.tmpid(),d=this.tmpid(),e=this.tmpid();if(b=b.push(),this.emitLine("frame = frame.push();"),this.emit("var "+e+" = "),this._compileExpression(a.arr,b),this.emitLine(";"),this.emit("if("+e+") {"),a.name instanceof f.Array){this.emitLine("var "+c+";"),this.emitLine("if(runtime.isArray("+e+")) {"),this.emitLine("var "+d+" = "+e+".length;"),this.emitLine("for("+c+"=0; "+c+" < "+e+".length; "+c+"++) {");for(var g=0;g<a.name.children.length;g++){var h=this.tmpid();this.emitLine("var "+h+" = "+e+"["+c+"]["+g+"]"),this.emitLine('frame.set("'+a.name.children[g].value+'", '+e+"["+c+"]["+g+"]);"),b.set(a.name.children[g].value,h)}this.emitLoopBindings(a,e,c,d),this.withScopedSyntax(function(){this.compile(a.body,b)}),this.emitLine("}"),this.emitLine("} else {");var i=a.name.children[0],j=a.name.children[1],k=this.tmpid(),l=this.tmpid();b.set(i.value,k),b.set(j.value,l),this.emitLine(c+" = -1;"),this.emitLine("var "+d+" = runtime.keys("+e+").length;"),this.emitLine("for(var "+k+" in "+e+") {"),this.emitLine(c+"++;"),this.emitLine("var "+l+" = "+e+"["+k+"];"),this.emitLine('frame.set("'+i.value+'", '+k+");"),this.emitLine('frame.set("'+j.value+'", '+l+");"),this.emitLoopBindings(a,e,c,d),this.withScopedSyntax(function(){this.compile(a.body,b)}),this.emitLine("}"),this.emitLine("}")}else{var l=this.tmpid();b.set(a.name.value,l),this.emitLine("var "+d+" = "+e+".length;"),this.emitLine("for(var "+c+"=0; "+c+" < "+e+".length; "+c+"++) {"),this.emitLine("var "+l+" = "+e+"["+c+"];"),this.emitLine('frame.set("'+a.name.value+'", '+l+");"),this.emitLoopBindings(a,e,c,d),this.withScopedSyntax(function(){this.compile(a.body,b)}),this.emitLine("}")}this.emitLine("}"),a.else_&&(this.emitLine("if (!"+d+") {"),this.compile(a.else_,b),this.emitLine("}")),this.emitLine("frame = frame.pop();")},_compileAsyncLoop:function(a,b,d){var e=this.tmpid(),g=this.tmpid(),h=this.tmpid(),i=d?"asyncAll":"asyncEach";if(b=b.push(),this.emitLine("frame = frame.push();"),this.emit("var "+h+" = "),this._compileExpression(a.arr,b),this.emitLine(";"),a.name instanceof f.Array)this.emit("runtime."+i+"("+h+", "+a.name.children.length+", function("),c.each(a.name.children,function(a){this.emit(a.value+",")},this),this.emit(e+","+g+",next) {"),c.each(a.name.children,function(a){var c=a.value;b.set(c,c),this.emitLine('frame.set("'+c+'", '+c+");")},this);else{var j=a.name.value;this.emitLine("runtime."+i+"("+h+", 1, function("+j+", "+e+", "+g+",next) {"),this.emitLine('frame.set("'+j+'", '+j+");"),b.set(j,j)}this.emitLoopBindings(a,h,e,g),this.withScopedSyntax(function(){var c;d&&(c=this.tmpid(),this.pushBufferId(c)),this.compile(a.body,b),this.emitLine("next("+e+(c?","+c:"")+");"),d&&this.popBufferId()});var k=this.tmpid();this.emitLine("}, "+this.makeCallback(k)),this.addScopeLevel(),d&&this.emitLine(this.buffer+" += "+k+";"),a.else_&&(this.emitLine("if (!"+h+".length) {"),this.compile(a.else_,b),this.emitLine("}")),this.emitLine("frame = frame.pop();")},compileAsyncEach:function(a,b){this._compileAsyncLoop(a,b)},compileAsyncAll:function(a,b){this._compileAsyncLoop(a,b,!0)},_compileMacro:function(a,b){var d=[],e=null,g="macro_"+this.tmpid();c.each(a.args.children,function(b,c){c===a.args.children.length-1&&b instanceof f.Dict?e=b:(this.assertType(b,f.Symbol),d.push(b))},this);var h=c.map(d,function(a){return"l_"+a.value});h.push("kwargs");var i=c.map(d,function(a){return'"'+a.value+'"'}),j=c.map(e&&e.children||[],function(a){return'"'+a.key.value+'"'});b=b.push(),this.emitLines("var "+g+" = runtime.makeMacro(","["+i.join(", ")+"], ","["+j.join(", ")+"], ","function ("+h.join(", ")+") {","frame = frame.push();","kwargs = kwargs || {};",'if (kwargs.hasOwnProperty("caller")) {','frame.set("caller", kwargs.caller); }'),c.each(d,function(a){this.emitLine('frame.set("'+a.value+'", l_'+a.value+");"),b.set(a.value,"l_"+a.value)},this),e&&c.each(e.children,function(a){var c=a.key.value;this.emit('frame.set("'+c+'", kwargs.hasOwnProperty("'+c+'") ? kwargs["'+c+'"] : '),this._compileExpression(a.value,b),this.emitLine(");")},this);var k=this.tmpid();return this.pushBufferId(k),this.withScopedSyntax(function(){this.compile(a.body,b)}),b=b.pop(),this.emitLine("frame = frame.pop();"),this.emitLine("return new runtime.SafeString("+k+");"),this.emitLine("});"),this.popBufferId(),g},compileMacro:function(a,b){var c=this._compileMacro(a,b),d=a.name.value;b.set(d,c),b.parent?this.emitLine('frame.set("'+d+'", '+c+");"):("_"!=a.name.value.charAt(0)&&this.emitLine('context.addExport("'+d+'");'),this.emitLine('context.setVariable("'+d+'", '+c+");"))},compileCaller:function(a,b){this.emit("(function (){");var c=this._compileMacro(a,b);this.emit("return "+c+";})()")},compileImport:function(a,b){var c=this.tmpid(),d=a.target.value;this.emit("env.getTemplate("),this._compileExpression(a.template,b),this.emitLine(", "+this.makeCallback(c)),this.addScopeLevel(),this.emitLine(c+".getExported("+this.makeCallback(c)),this.addScopeLevel(),b.set(d,c),this.emitLine(b.parent?'frame.set("'+d+'", '+c+");":'context.setVariable("'+d+'", '+c+");")},compileFromImport:function(a,b){var d=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(a.template,b),this.emitLine(", "+this.makeCallback(d)),this.addScopeLevel(),this.emitLine(d+".getExported("+this.makeCallback(d)),this.addScopeLevel(),c.each(a.names.children,function(a){var c,e,g=this.tmpid();a instanceof f.Pair?(c=a.key.value,e=a.value.value):(c=a.value,e=c),this.emitLine("if("+d+'.hasOwnProperty("'+c+'")) {'),this.emitLine("var "+g+" = "+d+"."+c+";"),this.emitLine("} else {"),this.emitLine("cb(new Error(\"cannot import '"+c+"'\")); return;"),this.emitLine("}"),b.set(e,g),this.emitLine(b.parent?'frame.set("'+e+'", '+g+");":'context.setVariable("'+e+'", '+g+");")},this)},compileBlock:function(a){if(!this.isChild){var b=this.tmpid();this.emitLine('context.getBlock("'+a.name.value+'")(env, context, frame, runtime, '+this.makeCallback(b)),this.emitLine(this.buffer+" += "+b+";"),this.addScopeLevel()}},compileSuper:function(a,b){var c=a.blockName.value,d=a.symbol.value;this.emitLine('context.getSuper(env, "'+c+'", b_'+c+", frame, runtime, "+this.makeCallback(d)),this.emitLine(d+" = runtime.markSafe("+d+");"),this.addScopeLevel(),b.set(d,d)},compileExtends:function(a,b){this.isChild&&this.fail("compileExtends: cannot extend multiple times",a.template.lineno,a.template.colno);var c=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(a.template,b),this.emitLine(", true, "+this.makeCallback("parentTemplate")),this.emitLine("for(var "+c+" in parentTemplate.blocks) {"),this.emitLine("context.addBlock("+c+", parentTemplate.blocks["+c+"]);"),this.emitLine("}"),this.addScopeLevel(),this.isChild=!0},compileInclude:function(a,b){var c=this.tmpid(),d=this.tmpid();this.emit("env.getTemplate("),this._compileExpression(a.template,b),this.emitLine(", "+this.makeCallback(c)),this.addScopeLevel(),this.emitLine(c+".render(context.getVariables(), frame.push(), "+this.makeCallback(d)),this.emitLine(this.buffer+" += "+d),this.addScopeLevel()},compileTemplateData:function(a,b){this.compileLiteral(a,b)},compileOutput:function(a,b){for(var c=a.children,d=0,e=c.length;e>d;d++)c[d]instanceof f.TemplateData?c[d].value&&(this.emit(this.buffer+" += "),this.compileLiteral(c[d],b),this.emitLine(";")):(this.emit(this.buffer+" += runtime.suppressValue("),this.compile(c[d],b),this.emit(", env.autoesc);\n"))},compileRoot:function(a,b){b&&this.fail("compileRoot: root node can't have frame"),b=new h,this.emitFuncBegin("root"),this._compileChildren(a,b),this.isChild&&this.emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this.emitFuncEnd(this.isChild),this.isChild=!1;for(var c=a.findAll(f.Block),d=0;d<c.length;d++){var e=c[d],g=e.name.value;this.emitFuncBegin("b_"+g);var i=new h;this.compile(e.body,i),this.emitFuncEnd()}this.emitLine("return {");for(var d=0;d<c.length;d++){var e=c[d],g="b_"+e.name.value;this.emitLine(g+": "+g+",")}this.emitLine("root: root\n};")},compile:function(a,b){var c=this["compile"+a.typename];c?c.call(this,a,b):this.fail("compile: Cannot compile node: "+a.typename,a.lineno,a.colno)},getCode:function(){return this.codebuf.join("")}});a.compiler={compile:function(a,b,c,f,g){var h=new j;if(c&&c.length)for(var i=0;i<c.length;i++)"preprocess"in c[i]&&(a=c[i].preprocess(a,f));return h.compile(e.transform(d.parse(a,c,g),b,f)),h.getCode()},Compiler:j}}(),function(){var b=a.lib,c=a.runtime,d={abs:function(a){return Math.abs(a)},batch:function(a,b,c){for(var d=[],e=[],f=0;f<a.length;f++)f%b===0&&e.length&&(d.push(e),e=[]),e.push(a[f]);if(e.length){if(c)for(var f=e.length;b>f;f++)e.push(c);d.push(e)}return d},capitalize:function(a){var b=a.toLowerCase();return c.copySafeness(a,b.charAt(0).toUpperCase()+b.slice(1))},center:function(a,d){if(d=d||80,a.length>=d)return a;var e=d-a.length,f=b.repeat(" ",e/2-e%2),g=b.repeat(" ",e/2);return c.copySafeness(a,f+a+g)},"default":function(a,b){return a?a:b},dictsort:function(a,c,d){if(!b.isObject(a))throw new b.TemplateError("dictsort filter: val must be an object");var e=[];for(var f in a)e.push([f,a[f]]);var g;if(void 0===d||"key"===d)g=0;else{if("value"!==d)throw new b.TemplateError("dictsort filter: You can only sort by either key or value");g=1}return e.sort(function(a,d){var e=a[g],f=d[g];return c||(b.isString(e)&&(e=e.toUpperCase()),b.isString(f)&&(f=f.toUpperCase())),e>f?1:e==f?0:-1}),e},escape:function(a){return"string"==typeof a||a instanceof c.SafeString?b.escape(a):a},safe:function(a){return c.markSafe(a)},first:function(a){return a[0]},groupby:function(a,c){return b.groupBy(a,c)},indent:function(a,d,e){d=d||4;for(var f="",g=a.split("\n"),h=b.repeat(" ",d),i=0;i<g.length;i++)f+=0!=i||e?h+g[i]+"\n":g[i]+"\n";return c.copySafeness(a,f)},join:function(a,c,d){return c=c||"",d&&(a=b.map(a,function(a){return a[d]})),a.join(c)},last:function(a){return a[a.length-1]},length:function(a){return void 0!==a?a.length:0},list:function(a){if(b.isString(a))return a.split("");if(b.isObject(a)){var c=[];if(Object.keys)c=Object.keys(a);else for(var d in a)c.push(d);return b.map(c,function(b){return{key:b,value:a[b]}})}throw new b.TemplateError("list filter: type not iterable")},lower:function(a){return a.toLowerCase()},random:function(a){return a[Math.floor(Math.random()*a.length)]},replace:function(a,b,d,e){if(b instanceof RegExp)return a.replace(b,d);var f=a,g=f,h=1;for(f=f.replace(b,d);g!=f&&!(h>=e);)g=f,f=f.replace(b,d),h++;return c.copySafeness(a,f)},reverse:function(a){var e;return e=b.isString(a)?d.list(a):b.map(a,function(a){return a}),e.reverse(),b.isString(a)?c.copySafeness(a,e.join("")):e},round:function(a,b,c){b=b||0;var d,e=Math.pow(10,b);return d="ceil"==c?Math.ceil:"floor"==c?Math.floor:Math.round,d(a*e)/e},slice:function(a,b,c){for(var d=Math.floor(a.length/b),e=a.length%b,f=0,g=[],h=0;b>h;h++){var i=f+h*d;e>h&&f++;var j=f+(h+1)*d,k=a.slice(i,j);c&&h>=e&&k.push(c),g.push(k)}return g},sort:function(a,c,d,e){return a=b.map(a,function(a){return a}),a.sort(function(a,f){var g,h;return e?(g=a[e],h=f[e]):(g=a,h=f),!d&&b.isString(g)&&b.isString(h)&&(g=g.toLowerCase(),h=h.toLowerCase()),h>g?c?1:-1:g>h?c?-1:1:0}),a},string:function(a){return c.copySafeness(a,a)},title:function(a){for(var b=a.split(" "),e=0;e<b.length;e++)b[e]=d.capitalize(b[e]);return c.copySafeness(a,b.join(" "))},trim:function(a){return c.copySafeness(a,a.replace(/^\s*|\s*$/g,""))},truncate:function(a,b,d,e){var f=a;if(b=b||255,a.length<=b)return a;if(d)a=a.substring(0,b);else{var g=a.lastIndexOf(" ",b);-1===g&&(g=b),a=a.substring(0,g)}return a+=void 0!==e&&null!==e?e:"...",c.copySafeness(f,a)},upper:function(a){return a.toUpperCase()},urlencode:function(a){var c=encodeURIComponent;if(b.isString(a))return c(a);var d;if(b.isArray(a))d=a.map(function(a){return c(a[0])+"="+c(a[1])});else{d=[];for(var e in a)a.hasOwnProperty(e)&&d.push(c(e)+"="+c(a[e]))}return d.join("&")},urlize:function(a,b,c){isNaN(b)&&(b=1/0);var d=c===!0?' rel="nofollow"':"",e=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,f=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,g=/^https?:\/\/.*$/,h=/^www\./,i=/\.(?:org|net|com)(?:\:|\/|$)/,j=a.split(/\s+/).filter(function(a){return a&&a.length}).map(function(a){var c=a.match(e),j=c&&c[1]||a;return g.test(j)?'<a href="'+j+'"'+d+">"+j.substr(0,b)+"</a>":h.test(j)?'<a href="http://'+j+'"'+d+">"+j.substr(0,b)+"</a>":f.test(j)?'<a href="mailto:'+j+'">'+j+"</a>":i.test(j)?'<a href="http://'+j+'"'+d+">"+j.substr(0,b)+"</a>":a});return j.join(" ")},wordcount:function(a){var b=a?a.match(/\w+/g):null;return b?b.length:null},"float":function(a,b){var c=parseFloat(a);return isNaN(c)?b:c},"int":function(a,b){var c=parseInt(a,10);return isNaN(c)?b:c}};d.d=d["default"],d.e=d.escape,a.filters=d}(),function(){function b(a){var b=-1;return this.current=null,{reset:function(){b=-1,this.current=null},next:function(){return b++,b>=a.length&&(b=0),this.current=a[b],this.current}}}function c(a){a=a||",";var b=!0;return function(){var c=b?"":a;return b=!1,c}}var d={range:function(a,b,c){b?c||(c=1):(b=a,a=0,c=1);for(var d=[],e=a;b>e;e+=c)d.push(e);return d},cycler:function(){return b(Array.prototype.slice.call(arguments))},joiner:function(a){return c(a)}};a.globals=d}(),function(){var b=a.object,c=a.lib,d=b.extend({on:function(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b)},emit:function(a){var b=Array.prototype.slice.call(arguments,1);this.listeners&&this.listeners[a]&&c.each(this.listeners[a],function(a){a.apply(null,b)})}});a.loader=d}(),function(){var b=a.loader,c=b.extend({init:function(a,b){this.precompiled=window.nunjucksPrecompiled||{},this.baseURL=a||"",this.neverUpdate=b},getSource:function(a){if(this.precompiled[a])return{src:{type:"code",obj:this.precompiled[a]},path:a};var b=this.fetch(this.baseURL+"/"+a);return b?{src:b,path:a,noCache:!this.neverUpdate}:null},fetch:function(a){var b,c,d=!0;return window.XMLHttpRequest?b=new XMLHttpRequest:window.ActiveXObject&&(b=new ActiveXObject("Microsoft.XMLHTTP")),b.onreadystatechange=function(){4!==b.readyState||0!==b.status&&200!==b.status||!d||(d=!1,c=b.responseText)},a+=(-1===a.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),b.open("GET",a,!1),b.send(),c}});a["web-loaders"]={WebLoader:c}}(),function(){a.loaders="undefined"==typeof window||window!==this?a["node-loaders"]:a["web-loaders"]}(),function(){var b=a.path,c=a.lib,d=a.object,e=(a.lexer,a.compiler),f=a.filters,g=a.loaders,h=a.runtime,i=a.globals,j=h.Frame,k=d.extend({init:function(a,b){b=b||{},this.dev=!!b.dev,this.lexerTags=b.tags,this.autoesc=!!b.autoescape,this.loaders=a?c.isArray(a)?a:[a]:g.FileSystemLoader?[new g.FileSystemLoader("views")]:[new g.WebLoader("/views")],this.initCache(),this.filters={},this.asyncFilters=[],this.extensions={},this.extensionsList=[];for(var d in f)this.addFilter(d,f[d])},initCache:function(){var a={};c.each(this.loaders,function(b){"function"==typeof b.on&&b.on("update",function(b){a[b]=null})}),this.cache=a},addExtension:function(a,b){b._name=a,this.extensions[a]=b,this.extensionsList.push(b)},getExtension:function(a){return this.extensions[a]},addGlobal:function(a,b){i[a]=b},addFilter:function(a,b,c){var d=b;c&&this.asyncFilters.push(a),this.filters[a]=d},getFilter:function(a){if(!this.filters[a])throw new Error("filter not found: "+a);return this.filters[a]},getTemplate:function(a,b,d){if(a&&a.raw&&(a=a.raw),c.isFunction(b)&&(d=b,b=!1),"string"!=typeof a)throw new Error("template names must be a string: "+a);var e=this.cache[a];if(!e){var f;return c.asyncIter(this.loaders,function(b,c,d,e){function f(a){a?e(a):d()}b.async?b.getSource(a,function(a,b){if(a)throw a;f(b)}):f(b.getSource(a))},function(c){if(c){var e=new m(c.src,this,c.path,b);c.noCache||(this.cache[a]=e),d?d(null,e):f=e}else{var g=new Error("template not found: "+a);if(!d)throw g;d(g)}}.bind(this)),f}return b&&e.compile(),d?void d(null,e):e},express:function(a){function c(a,c){if(this.name=a,this.path=a,this.defaultEngine=c.defaultEngine,this.ext=b.extname(a),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}var d=this;c.prototype.render=function(a,b){d.render(this.name,a,b)},a.set("view",c)},render:function(a,b,d){c.isFunction(b)&&(d=b,b=null);var e=null;return this.getTemplate(a,function(a,c){if(a&&d)d(a);else{if(a)throw a;c.render(b,d||function(a,b){if(a)throw a;e=b})}}),e},renderString:function(a,b,c){var d=new m(a,this);return d.render(b,c)}}),l=d.extend({init:function(a,b){this.ctx=a,this.blocks={},this.exported=[];for(var c in b)this.addBlock(c,b[c])},lookup:function(a){return a in i&&!(a in this.ctx)?i[a]:this.ctx[a]},setVariable:function(a,b){this.ctx[a]=b},getVariables:function(){return this.ctx},addBlock:function(a,b){this.blocks[a]=this.blocks[a]||[],this.blocks[a].push(b)},getBlock:function(a){if(!this.blocks[a])throw new Error('unknown block "'+a+'"');return this.blocks[a][0]},getSuper:function(a,b,d,e,f,g){var h=c.indexOf(this.blocks[b]||[],d),i=this.blocks[b][h+1],j=this;if(-1==h||!i)throw new Error('no super block available for "'+b+'"');i(a,j,e,f,g)},addExport:function(a){this.exported.push(a)},getExported:function(){for(var a={},b=0;b<this.exported.length;b++){var c=this.exported[b];a[c]=this.ctx[c]}return a}}),m=d.extend({init:function(a,b,d,e){if(this.env=b||new k,c.isObject(a))switch(a.type){case"code":this.tmplProps=a.obj;break;case"string":this.tmplStr=a.obj}else{if(!c.isString(a))throw new Error("src must be a string or an object describing the source");this.tmplStr=a}this.path=d,e?c.withPrettyErrors(this.path,this.env.dev,this._compile.bind(this)):this.compiled=!1},render:function(a,b,d){return"function"==typeof a?(d=a,a={}):"function"==typeof b&&(d=b,b=null),c.withPrettyErrors(this.path,this.env.dev,function(){this.compile();var c=new l(a||{},this.blocks),e=null;return this.rootRenderFunc(this.env,c,b||new j,h,d||function(a,b){if(a)throw a;e=b}),e}.bind(this))},getExported:function(a){this.compile();var b=new l({},this.blocks);this.rootRenderFunc(this.env,b,new j,h,function(){a(null,b.getExported())})},compile:function(){this.compiled||this._compile()},_compile:function(){var a;if(this.tmplProps)a=this.tmplProps;else{var b=e.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.lexerTags),c=new Function(b);a=c()}this.blocks=this._getBlocks(a),this.rootRenderFunc=a.root,this.compiled=!0},_getBlocks:function(a){var b={};for(var c in a)"b_"==c.slice(0,2)&&(b[c.slice(2)]=a[c]);return b}});a.environment={Environment:k,Template:m}}();var b,c=a.lib,d=a.environment,e=a.compiler,f=a.parser,g=a.lexer,h=a.runtime,i=a.loader,j=a.loaders,k=a.precompile;b={},b.Environment=d.Environment,b.Template=d.Template,b.Loader=i,b.FileSystemLoader=j.FileSystemLoader,b.WebLoader=j.WebLoader,b.compiler=e,b.parser=f,b.lexer=g,b.runtime=h;var l;b.configure=function(a,b){b=b||{},c.isObject(a)&&(b=a,a=null);var e="watch"in b?!b.watch:!1,f=j.FileSystemLoader||j.WebLoader;return l=new d.Environment(new f(a,e),b),b&&b.express&&l.express(b.express),l},b.compile=function(a,c,d,e){return l||b.configure(),new b.Template(a,c,d,e)},b.render=function(a,c,d){return l||b.configure(),l.render(a,c,d)},b.renderString=function(a,c,d){return l||b.configure(),l.renderString(a,c,d)},k&&(b.precompile=k.precompile,b.precompileString=k.precompileString),b.require=function(b){return a[b]},"function"==typeof define&&define.amd?define(function(){return b}):(window.nunjucks=b,"undefined"!=typeof module&&(module.exports=b))}(),function(a){function b(b,c){var d=a.toString.call(b).charAt(8);return"R"===d?b.test(c):"F"===d?b(c):b==c}var c=/[\-\[\]{}()+?.,\\\^$|#\s]/g,d=/([:*])(\w+)/g;a.routeMatcher=function(a,e){var f={},g=[],h=a;return"string"==typeof a?(h=h.replace(c,"\\$&"),h=h.replace(d,function(a,b,c){return g.push(c),":"===b?"([^/]*)":"(.*)"}),h=new RegExp("^"+h+"$"),f.parse=function(a){var c,d,f=0,i={},j=a.match(h);if(!j)return null;for(;f<g.length;){if(c=g[f++],d=j[f],e&&c in e&&!b(e[c],d))return null;i[c]=d}return i},f.stringify=function(b){var c,e,f=a;for(c in b)e=new RegExp("[:*]"+c+"\\b"),f=f.replace(e,b[c]);return f.replace(d,"")}):(f.parse=function(a){var b=a.match(h);return b&&{captures:b.slice(1)}},f.stringify=function(){return""}),f}}("object"==typeof exports&&exports||this),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";
else"string"==typeof c&&(indent=c);if(rep=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length)return str("",{"":a});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b){"use strict";var c=a.History=a.History||{};if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");c.Adapter={handlers:{},_uid:1,uid:function(a){return a._uid||(a._uid=c.Adapter._uid++)},bind:function(a,b,d){var e=c.Adapter.uid(a);c.Adapter.handlers[e]=c.Adapter.handlers[e]||{},c.Adapter.handlers[e][b]=c.Adapter.handlers[e][b]||[],c.Adapter.handlers[e][b].push(d),a["on"+b]=function(a,b){return function(d){c.Adapter.trigger(a,b,d)}}(a,b)},trigger:function(a,b,d){d=d||{};var e,f,g=c.Adapter.uid(a);for(c.Adapter.handlers[g]=c.Adapter.handlers[g]||{},c.Adapter.handlers[g][b]=c.Adapter.handlers[g][b]||[],e=0,f=c.Adapter.handlers[g][b].length;f>e;++e)c.Adapter.handlers[g][b][e].apply(this,[d])},extractEventData:function(a,c){var d=c&&c[a]||b;return d},onDomLoad:function(b){var c=a.setTimeout(function(){b()},2e3);a.onload=function(){clearTimeout(c),b()}}},"undefined"!=typeof c.init&&c.init()}(window),function(a){"use strict";var b=a.document,c=a.setTimeout||c,d=a.clearTimeout||d,e=a.setInterval||e,f=a.History=a.History||{};if("undefined"!=typeof f.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");f.initHtml4=function(){return"undefined"!=typeof f.initHtml4.initialized?!1:(f.initHtml4.initialized=!0,f.enabled=!0,f.savedHashes=[],f.isLastHash=function(a){var b,c=f.getHashByIndex();return b=a===c},f.isHashEqual=function(a,b){return a=encodeURIComponent(a).replace(/%25/g,"%"),b=encodeURIComponent(b).replace(/%25/g,"%"),a===b},f.saveHash=function(a){return f.isLastHash(a)?!1:(f.savedHashes.push(a),!0)},f.getHashByIndex=function(a){var b=null;return b="undefined"==typeof a?f.savedHashes[f.savedHashes.length-1]:0>a?f.savedHashes[f.savedHashes.length+a]:f.savedHashes[a]},f.discardedHashes={},f.discardedStates={},f.discardState=function(a,b,c){var d,e=f.getHashByState(a);return d={discardedState:a,backState:c,forwardState:b},f.discardedStates[e]=d,!0},f.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};return f.discardedHashes[a]=d,!0},f.discardedState=function(a){var b,c=f.getHashByState(a);return b=f.discardedStates[c]||!1},f.discardedHash=function(a){var b=f.discardedHashes[a]||!1;return b},f.recycleState=function(a){var b=f.getHashByState(a);return f.discardedState(a)&&delete f.discardedStates[b],!0},f.emulated.hashChange&&(f.hashChangeInit=function(){f.checkerFunction=null;var c,d,g,h,i="",j=Boolean(f.getHash());return f.isInternetExplorer()?(c="historyjs-iframe",d=b.createElement("iframe"),d.setAttribute("id",c),d.setAttribute("src","#"),d.style.display="none",b.body.appendChild(d),d.contentWindow.document.open(),d.contentWindow.document.close(),g="",h=!1,f.checkerFunction=function(){if(h)return!1;h=!0;var b=f.getHash(),c=f.getHash(d.contentWindow.document);return b!==i?(i=b,c!==b&&(g=c=b,d.contentWindow.document.open(),d.contentWindow.document.close(),d.contentWindow.document.location.hash=f.escapeHash(b)),f.Adapter.trigger(a,"hashchange")):c!==g&&(g=c,j&&""===c?f.back():f.setHash(c,!1)),h=!1,!0}):f.checkerFunction=function(){var b=f.getHash()||"";return b!==i&&(i=b,f.Adapter.trigger(a,"hashchange")),!0},f.intervalList.push(e(f.checkerFunction,f.options.hashChangeInterval)),!0},f.Adapter.onDomLoad(f.hashChangeInit)),f.emulated.pushState&&(f.onHashChange=function(b){var c,d=b&&b.newURL||f.getLocationHref(),e=f.getHashByUrl(d),g=null,h=null;return f.isLastHash(e)?(f.busy(!1),!1):(f.doubleCheckComplete(),f.saveHash(e),e&&f.isTraditionalAnchor(e)?(f.Adapter.trigger(a,"anchorchange"),f.busy(!1),!1):(g=f.extractState(f.getFullUrl(e||f.getLocationHref()),!0),f.isLastSavedState(g)?(f.busy(!1),!1):(h=f.getHashByState(g),c=f.discardedState(g),c?(f.getHashByIndex(-2)===f.getHashByState(c.forwardState)?f.back(!1):f.forward(!1),!1):(f.pushState(g.data,g.title,encodeURI(g.url),!1),!0))))},f.Adapter.bind(a,"hashchange",f.onHashChange),f.pushState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),f.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(e!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.pushState,args:arguments,queue:e}),!1;f.busy(!0);var g=f.createStateObject(b,c,d),h=f.getHashByState(g),i=f.getState(!1),j=f.getHashByState(i),k=f.getHash(),l=f.expectedStateId==g.id;return f.storeState(g),f.expectedStateId=g.id,f.recycleState(g),f.setTitle(g),h===j?(f.busy(!1),!1):(f.saveState(g),l||f.Adapter.trigger(a,"statechange"),!f.isHashEqual(h,k)&&!f.isHashEqual(h,f.getShortUrl(f.getLocationHref()))&&f.setHash(h,!1),f.busy(!1),!0)},f.replaceState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),f.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(e!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.replaceState,args:arguments,queue:e}),!1;f.busy(!0);var g=f.createStateObject(b,c,d),h=f.getHashByState(g),i=f.getState(!1),j=f.getHashByState(i),k=f.getStateByIndex(-2);return f.discardState(i,g,k),h===j?(f.storeState(g),f.expectedStateId=g.id,f.recycleState(g),f.setTitle(g),f.saveState(g),f.Adapter.trigger(a,"statechange"),f.busy(!1)):f.pushState(g.data,g.title,g.url,!1),!0}),f.emulated.pushState&&f.getHash()&&!f.emulated.hashChange&&f.Adapter.onDomLoad(function(){f.Adapter.trigger(a,"hashchange")}),void 0)},"undefined"!=typeof f.init&&f.init()}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;try{f.setItem("TEST","1"),f.removeItem("TEST")}catch(o){f=!1}if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");m.init=function(){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.disableSuid=m.options.disableSuid||!1,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.options.html4Mode=m.options.html4Mode||!1,m.options.delayInit=m.options.delayInit||!1,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h="undefined"!=typeof c&&"undefined"!=typeof c.log&&"undefined"!=typeof c.log.apply,i=d.getElementById("log");for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;e>b;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)}catch(j){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated=m.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||m.getLocationHref();return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.getLocationHref=function(a){return a=a||d,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:-1==a.URL.indexOf("#")&&-1!=a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof m.idToState[c]||"undefined"!=typeof m.store.idToState[c];);m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(a.url?a.url:m.getLocationHref()),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&m.options.disableSuid!==!0&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d,e;return e=-1!=a.indexOf("#")?a.split("#")[0]:a,c=/(.*)\&_suid=([0-9]+)$/.exec(e),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),!e&&b&&!m.isTraditionalAnchor(a)&&(e=m.createStateObject(null,null,d))),e},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]},m.getCurrentIndex=function(){var a=null;return a=m.savedStates.length<1?0:m.savedStates.length-1},m.getHash=function(a){var b,c=m.getLocationHref(a);return b=m.getHashByUrl(c)},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=decodeURIComponent(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(m.busy(!0),c=m.extractState(a,!0),c&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(e=m.getPageUrl(),m.pushState(null,null,e+"#"+a,!1)):d.location.hash=a),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.encodeURIComponent(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(m.getLocationHref());return m.isLastSavedState(c)?void 0:(b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m)},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var d,e,f=!1,g=!1;return m.doubleCheckComplete(),d=m.getHash(),d?(e=m.extractState(d||m.getLocationHref(),!0),e?m.replaceState(e.data,e.title,e.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(f=m.Adapter.extractEventData("state",b,c)||!1,g=f?m.getStateById(f):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()),g||(g=m.createStateObject(null,null,m.getLocationHref())),m.expectedStateId=!1,m.isLastSavedState(g)?(m.busy(!1),!1):(m.storeState(g),m.saveState(g),m.setTitle(g),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0))),f&&(m.onUnload=function(){var a,b,c;try{a=k.parse(f.getItem("History.store"))||{}}catch(d){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),c=k.stringify(a);try{f.setItem("History.store",c)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;f.length&&(f.removeItem("History.store"),f.setItem("History.store",c))}},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},(!m.options||!m.options.delayInit)&&m.init()}(window)(function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});if(e(f,{left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h})),function(a,b){"use strict";"function"==typeof define&&define.amd?define(["exports"],b):b("object"==typeof exports?exports:a.PubSub={})}("object"==typeof window&&window||this,function(a){"use strict";function b(a){var b;for(b in a)if(a.hasOwnProperty(b))return!0;return!1}function c(a){return function(){throw a}}function d(a,b,d){try{a(b,d)}catch(e){setTimeout(c(e),0)}}function e(a,b,c){a(b,c)}function f(a,b,c,f){var g,h=j[b],i=f?e:d;if(j.hasOwnProperty(b))for(g in h)h.hasOwnProperty(g)&&i(h[g],a,c)}function g(a,b,c){return function(){var d=String(a),e=d.lastIndexOf(".");for(f(a,a,b,c);-1!==e;)d=d.substr(0,e),e=d.lastIndexOf("."),f(a,d,b)}}function h(a){for(var c=String(a),d=Boolean(j.hasOwnProperty(c)&&b(j[c])),e=c.lastIndexOf(".");!d&&-1!==e;)c=c.substr(0,e),e=c.lastIndexOf("."),d=Boolean(j.hasOwnProperty(c)&&b(j[c]));return d}function i(a,b,c,d){var e=g(a,b,d),f=h(a);return f?(c===!0?e():setTimeout(e,0),!0):!1}var j={},k=-1;a.publish=function(b,c){return i(b,c,!1,a.immediateExceptions)},a.publishSync=function(b,c){return i(b,c,!0,a.immediateExceptions)},a.subscribe=function(a,b){if("function"!=typeof b)return!1;j.hasOwnProperty(a)||(j[a]={});var c="uid_"+String(++k);return j[a][c]=b,c},a.clearAllSubscriptions=function(){j={}},a.unsubscribe=function(a){var b,c,d,e="string"==typeof a&&j.hasOwnProperty(a),f=!e&&"string"==typeof a,g="function"==typeof a,h=!1;if(e)return void delete j[a];for(b in j)if(j.hasOwnProperty(b)){if(c=j[b],f&&c[a]){delete c[a],h=a;break}if(g)for(d in c)c.hasOwnProperty(d)&&c[d]===a&&(delete c[d],h=!0)}return h}});var FramesCore;FramesCore=function(){function FramesCore(a){this.name=a}return FramesCore.prototype.core_objects={},FramesCore.prototype.base_path=null,FramesCore.prototype.parseURL=function(){var a,b;return b=this,this.base_path||!function(){var a,c,d,e,f,g;for(e=document.getElementsByTagName("script"),a=e.length-1,g=[];a>=0;)f=e[a].src,c=f.length,d=f.substr(f.lastIndexOf("/")+1).length,f.indexOf("frames-")>-1&&(b.base_path=f.substr(0,c-d),b.base_path.indexOf("core")>-1&&(b.base_path=b.base_path+"../"),nunjucks.configure(b.base_path+"/views",{noCache:!0,autoescape:!1})),g.push(--a);return g}(),window.scrollTo(0,0),a=window.location.hash,b.current_route="#!/"===a||"#/"===a||""===a?"/":a.replace("#","").replace("!",""),frames_router.matchRoute(b.current_route)},FramesCore.prototype.constructObject=function(str){var obj;return obj=str.split("."),this.controller=obj[0],this.action=obj[1],this.isConstructed()||(this.core_objects[this.controller]=eval("new "+this.controller)),eval("this.core_objects['"+this.controller+"']."+this.action+"()")},FramesCore.prototype.isConstructed=function(){var a,b,c;b=void 0,c=void 0,b=!1,c=0;for(a in this.core_objects)a===this.controller&&(b=!0);return b},FramesCore.prototype.renderView=function(a){var b=frames_core.controller.toLocaleLowerCase()+"/"+frames_core.action.toLocaleLowerCase()+".html";nunjucks.render(b,a.data,function(a,b){$("#yield").html(b),setTimeout(function(){frames_helper.hideLoader(),PubSub.publish("view_rendered")})}),FramesCore.prototype.viewRendered=function(a){PubSub.clearAllSubscriptions(),PubSub.subscribe("view_rendered",a)}},FramesCore}();var FramesHelper;FramesHelper=function(a){return FramesHelper=function(a){return this.name=a},FramesHelper.prototype={presentLoader:function(){var b,c,d,e,f;return b=void 0,c=void 0,d=void 0,e=void 0,f=void 0,e=a(window).outerHeight(!0),f=a(window).outerWidth(!0),0===a("#frames-loader").length&&(b='<div id ="frames-loader"></div>',a("body").append(b)),a("#frames-loader").css({padding:"10px",background:"#000",color:"#FFF",width:100,height:100,"text-align":"center",position:"absolute",top:e/2-60,left:f/2-60,"z-index":2e3,display:"none","border-radius":"10px"},c={lines:7,length:7,width:2,radius:6,corners:1,rotate:50,color:"#FFF",speed:1,trail:56,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"60px",left:"60px"}),a("#frames-loader").show(),d=document.getElementById("frames-loader"),null==this.spinner?this.spinner=new Spinner(c).spin(d):void 0},hideLoader:function(){return a("#frames-loader").hide()},present404:function(){a.ajax({url:frames_core.base_path+"views/404.html",dataType:"html",success:function(b){a("#yield").html(b)}})}},FramesHelper}(window.jQuery);var FramesRouter;FramesRouter=function(){function a(a){this.routeMatcher=routeMatcher,this.name=a}return a.prototype.routes={},a.prototype.params={},a.prototype.addRoute=function(a,b){return this.routes[a]=b},a.prototype.matchRoute=function(a){var b,c,d;c=!1;for(b in frames_router.routes)"/"!==b&&(d=this.routeMatcher(b),d=d.parse(window.location.hash.replace("#","").replace("!","")),is_.object(d)&&(this.params=d,frames_core.constructObject(this.routes[b]),c=!0));return"/"===a&&(c=!0,frames_core.constructObject(this.routes["/"])),c||frames_helper.present404(),c?frames_helper.presentLoader():void 0},a.prototype.setVariables=function(a,b){var c,d,e;for(a=a.split("/"),c=0,d=1,e=[];c<a.length;)a[c].indexOf(":")>-1&&(a[c]=a[c].substr(1),this.variables[a[c]]=b[d],d++),e.push(c++);return e},a}();var frames_core,frames_helper,frames_router;frames_core=new FramesCore,frames_router=new FramesRouter,frames_helper=new FramesHelper;var Pages=function(){function a(a){this.name=a}return a.prototype={index:function(){var a=new Page;frames_core.renderView(a.getData()),frames_core.viewRendered(function(){})}},a}(),Page=function(){return Page=function(a){this.name=a},Page.prototype={getData:function(){return{data:{title:"Hi! Welcome to Frames!",text:"Hope you enjoy this fun little framework."}}}},Page}();frames_router.addRoute("/","Pages.index"),frames_core.parseURL();

}).call(window.jQuery)